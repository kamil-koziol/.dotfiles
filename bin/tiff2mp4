#!/bin/sh

Help()
{
   # Display Help
   echo "Script to combine tiff images and make mp4"
   echo
   echo "Syntax: tiff2mp4 [-h|f|o]"
   echo "options:"
   echo "h     Help."
   echo "f     Set frame rate."
   echo "o     Change output file name."
   echo
}

FRAME_RATE=60
OUTPUT='video.mp4'

while getopts ":hfo:" option; do
    case $option in
        h) # display Help
            Help
            exit;;
        f)
            if [[ $OPTARG -lt 1 ]]; then
                echo "Frame rate cannot be lower than or equal 0"
                exit
            fi
            FRAME_RATE=$OPTARG;;
        o)
            if [[ -z $OPTARG ]]; then
                echo "File name cannot be empty"
                exit
            fi

            OUTPUT=$OPTARG;;

        \?) # Invalid option
         echo "Error: Invalid option"
         Help
         exit;;
   esac
done

ffmpeg -framerate $FRAME_RATE -i "frame%02d.tif" -pix_fmt yuv420p -vcodec h264 -refs 16 -preset ultrafast $OUTPUT